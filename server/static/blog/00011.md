## èƒŒæ™¯ï¼šä¸€åˆ‡çš„å§‹ç‚¹

å¤´ç–¼çš„é—®é¢˜ï¼šä¹‹å‰ä»¥ä¸ºUnityçš„æ¸²æŸ“æ˜¯é Libraryæ–‡ä»¶å¤¹å®Œæˆçš„ï¼Œäºæ˜¯å¤©çœŸçš„åœ¨GitHubä¸­ä¸Šä¼ äº†Libraryã€‚ç„¶è€ŒLibraryä¸­æœ‰äº›æ–‡ä»¶æ˜¯å¾ˆå¤§çš„ï¼Œäºæ˜¯èªæ˜çš„æˆ‘å°±ç”¨äº†Git LFSæ·»åŠ äº†è¿™äº›å¤§æ–‡ä»¶ã€‚ç„¶è€Œéšç€Unityåº“å¤šèµ·æ¥äº†ï¼ŒLFSçš„é™é¢åˆ°äº†ï¼Œäºæ˜¯èªæ˜çš„æˆ‘é€‰æ‹©æ°ª5åˆ€ï¼ˆæŠ˜åˆè½¯å¦¹å¸30å¤šï¼‰æ‹“å®¹ã€‚ç„¶è€Œç›´åˆ°ä¸€å¤©æ— å¿ƒçœ‹åˆ°æŸè‰å­¦é•¿çš„Unityåº“ï¼Œå‘ç°ä»–çš„åº“é‡Œæ²¡æœ‰Libraryï¼Œåªæœ‰metaæ–‡ä»¶å’Œ.gitignoreï¼Œé‡Œé¢èµ«ç„¶å±è”½äº†Libraryã€‚äºæ˜¯æˆ‘ç»ˆäºå‘ç°æˆ‘ä¹‹å‰å±è”½çš„metaæ–‡ä»¶æ‰æ˜¯èƒ½å¤Ÿä¿å­˜è´´å›¾çš„ç½ªé­ç¥¸é¦–ï¼~~ï¼ˆä¸çŸ¥é“è¯¥ç”¨å•¥è¯ï¼Œå°†å°±ä¸€ä¸‹ï¼‰~~ï¼ˆå› ä¸ºæˆ‘çœ‹åˆ°metaæ–‡ä»¶é‚£ä¹ˆå¤šä»¥ä¸ºæ˜¯Unityçš„ä¸´æ—¶æ–‡ä»¶ï¼Œå«Œçƒ¦ğŸ˜…ï¼‰

ç„¶é¹…ï¼Œè®¤è¯†åˆ°é”™è¯¯æ²¡æœ‰ç”¨ã€‚å°±åœ¨æˆ‘ä½¿ç”¨git pushæ„å›¾ç­æ‰LFSå¤§æ–‡ä»¶æ—¶ï¼Œä¸€çœ‹Billing and Plansï¼Œå‘ç°ï¼šStorageçš„å®¹é‡æ²¡æœ‰ä¸æ¯«å‡å°‘ï¼Œè¿˜å ç€å‘¢

az...

äºæ˜¯åªèƒ½å»å¯»æ‰¾å¦‚ä½•åˆ é™¤LFS Storageï¼Œä»¥é¿å…ä¸‹ä¸ªæœˆä¿¡ç”¨å¡åˆè¢«æ‰£5åˆ€ã€‚

## æœ‰ç”¨çš„é“¾æ¥

å®˜æ–¹åˆ é™¤æ–¹æ³•ï¼š

[1] https://docs.github.com/en/enterprise-server@3.1/repositories/working-with-files/managing-large-files/removing-files-from-git-large-file-storage

[2] https://docs.github.com/en/enterprise-server@3.1/authentication/keeping-your-account-and-data-secure/removing-sensitive-data-from-a-repository

[3] https://rtyley.github.io/bfg-repo-cleaner/

æ°‘é—´å¤§ç¥ï¼š

[4] https://www.cnblogs.com/huipengly/p/8424096.html

[5] https://blog.csdn.net/wpwalter/article/details/103760520

[6] https://stackoverflow.com/questions/34579211/how-to-delete-a-file-tracked-by-git-lfs-and-release-the-storage-quota

## æœ¬äººæ“ä½œ

### bfgå®‰è£…

è§‚å‰æç¤ºï¼šæœ¬äººæ˜¯åœ¨**Windows**ç³»ç»Ÿä¸Šæ“ä½œçš„ï¼ŒMacå’ŒLinuxè¯·è‡ªè¡Œç¢ç£¨ã€‚

é¦–å…ˆè¯•äº†filter-branchï¼Œæ„Ÿè§‰ä¸å¥½ç”¨ï¼Œæ‰€ä»¥è¿˜æ˜¯ç”¨äº†çœŸé¦™çš„bfgã€‚

bfgçš„å®‰è£…æ–¹æ³•è¯¦è§[5]ã€‚æˆ‘é‡‡ç”¨äº†â€œä½¿ç”¨åŒ…ç®¡ç†å™¨ scoop å®‰è£…â€ã€‚Win+Rè¾“å…¥powershellè¿›å…¥ç•Œé¢ï¼Œç„¶å

```
iex (new-object net.webclient).downloadstring('https://get.scoop.sh')
```

å®‰è£…scoopã€‚ç„¶å

```
PS C:\Users\xrr> scoop install bfg
Couldn't find manifest for 'bfg'.
```

é»è§£å•Šï¼Ÿ

```
PS C:\Users\xrr> scoop bucket list
WARN  No bucket found. Please run 'scoop bucket add main' to add the default 'main' bucket.
```

é‚£æ²¡äº‹äº†

```
PS C:\Users\xrr> scoop bucket add main
Checking repo... OK
The main bucket was added successfully.
```

ç„¶åæŒ‰ç…§[5]çš„æŒ‡ç¤º

- `scoop install bfg`
- `scoop bucket add java`
- `scoop install java/openjdk`

å°±è¡Œäº†ã€‚

### åˆ é™¤æ–‡ä»¶

å®˜ç½‘[3]ä¸Šæœ‰bfgçš„å…·ä½“ç”¨æ³•ã€‚æ­¤å¤„å±•ç¤ºæˆ‘çš„æ­¥éª¤ã€‚

1. åŠ **mirror** cloneåº“

   `git clone --mirror https://github.com/{{ ä½ çš„ç”¨æˆ·å }}/{{ ä½ çš„åº“ }}.git`

2. ä¸‹å¥½ä»¥å`cd {{ ä½ çš„åº“ }}.git`ï¼›

3. `git lfs ls-files`çœ‹çœ‹ä½ æœ‰å“ªäº›æ–‡ä»¶æ˜¯å¤§æ–‡ä»¶ï¼Œåœ¨å“ªï¼›

4. ç„¶åä½ å°±å¯ä»¥åˆ ä¸œè¥¿äº†ã€‚å‚ç…§[3], [4], [5]ä¸­ç»™çš„æ ·ä¾‹ï¼Œä½ è‡ªå·±æ–Ÿé…Œï¼ˆæ³¨æ„`--no-blob-protection`ï¼‰ï¼›

5. bfgè·‘å®Œæœ€åä¼šç»™ä½ æç¤º

   `BFG run is complete! When ready, run: git reflog expire --expire=now --all && git gc --prune=now --aggressive`

   é‚£å°±æŒ‰ä»–è¯´çš„åšï¼ŒæŠŠè¿™ä¸¤å¥æ‰§è¡Œäº†

6. æœ€å`git push`

æ­¤æ—¶çœ‹GitHubä¸­çš„åº“ï¼Œæ–‡ä»¶ç¡®å®å·²ç»æ¶ˆå¤±äº†ã€‚

### åˆ åº“è·‘è·¯

ä½ ä»¥ä¸ºå¥½äº†ã€‚ç»“æœä¸€å»Billing and Plansï¼Œå‘ç°ï¼šå‹æ ¹æ²¡å˜å•Šï¼Ÿ

ä½ ä»”ç»†çœ‹çœ‹[1]ä¸­çš„è¦æ±‚ï¼Œå‘ç°ï¼š

> After you remove files from Git LFS, the Git LFS objects still exist on the remote storage.
>
> To remove Git LFS objects from a repository, contact your GitHub Enterprise administrator to archive the objects. Archived objects are purged after three months.

az...

é‚£ä¹ˆï¼Œå°±å¾—ç”¨äº›æš´åŠ›ç‚¹çš„æ–¹æ³•äº†ã€‚å¦‚æœä½ æ‡’å¾—å»contactï¼Œæœ€æš´åŠ›çš„æ–¹æ³•å°±æ˜¯ï¼š

ç›´æ¥åˆ åº“è·‘è·¯ä¸€ä¸€ <(ã£///c)

ä½†åˆ å¯ä¸æ˜¯ä¹±åˆ çš„å•Š~å‚è€ƒ[6]ï¼Œè¿™ä½ChrisåŒå¿—è¯´å¾—å¥½ï¼š

> According to GitHubs documentation (https://help.github.com/articles/removing-files-from-git-large-file-storage/), it is recommended to delete and recreate a repository: "To remove Git LFS objects from a repository, delete and recreate the repository. When you delete a repository, any associated issues, stars, and forks are also deleted."

ä¸‹é¢æœ‰ä¸€å¥è¯„è®ºä¹Ÿè¯´å¾—å¥½ï¼š

> Well that's a terrible solution.

é‚£å’‹åŠå’§ï¼Ÿä¸‹é¢åˆæœ‰ä¸€ä½BrandtåŒå¿—è¯´ï¼ˆæ¯”è¾ƒé•¿ï¼Œä½†å¾ˆæœ‰æ„æ€ï¼‰ï¼š

> The answer given by Chris is not accurate; combined with the comment from 0xcaff ("*that's a terrible solution*"), it may mislead the inexperient user (or distracted reader).
>
> The right answer is a mixture of Wader's and Chris'.

ï¼ˆWaderæ˜¯[6]é‡Œé¢å¦ä¸€ä¸ªäººï¼‰

> So, if you want to get rid of LFS and any reference to the once-tracked files you have to:
>
> 1. uninstall LFS from the repo;
> 2. clean the repo's history;
> 3. delete (or rename) the old (github) repo, create a new one and push the cleaned repo into it.

å‰ä¸¤æ­¥æˆ‘ä»¬å·²ç»åšå®Œäº†ï¼Œç›´æ¥çœ‹3

> ### 3
>
> The deletion and re-creation of the repository is not as destructive at seems like, remember that your local repository is completely independent, self-sustained *clone* of what's in Github. When you push the your local (clean) version to the new, blank repository it will be like that (deletion/creation) never happened.

é†é†çŒé¡¶ï¼

é‚£ä¹ˆï¼Œæˆ‘åªè¦æŠŠæœ¬åœ°.gitåº“è¿ç»“åˆ°å¦ä¸€ä¸ªGitHubè¿œç¨‹åº“ä¸Šï¼Œå†æŠŠåŸGitHubåº“åˆ äº†ï¼Œæ—¢å¯ä»¥ç¬é—´è…¾ç©ºLFS Storageï¼Œåˆä¸ä¼šä¸¢commitè®°å½•ï¼ˆé™¤äº†ä½ åŸæ¥çš„LFSè®°å½•ï¼‰ï¼Œå²‚ä¸æ˜¯çš†å¤§æ¬¢å–œï¼Ÿ

è¯´å¹²å°±å¹²ï¼

1. é¦–å…ˆæˆ‘æŠŠåˆšåˆšä¿®æ”¹çš„æ—§åº“pullåˆ°ä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ã€‚è¿™ä¸€æ­¥å¾—åšï¼Œä¸ç„¶åŸæ¥çš„æœ¬åœ°.gitåº“æ˜¯ä¿ç•™äº†åŸæ¥LFSçš„ä¿¡æ¯çš„ï¼ˆåˆšæ‰çš„â€œåˆ é™¤æ–‡ä»¶â€æ“ä½œæ˜¯é’ˆå¯¹è¿œç¨‹åº“è¿›è¡Œçš„ä¿®æ”¹ï¼‰
2. åˆ å»ä¹‹å‰é…ç½®çš„LFS .gitattributesï¼ˆæˆ–è€…æ ¹æ®ä½ è‡ªå·±çš„æƒ…å†µåˆ å‡ï¼‰
3. commitï¼Œå†push

4. å½“ç„¶ä½ è‡ªå·±å¾—é•¿ç‚¹å¿ƒçœ¼ï¼Œåˆ«ä¸å°å¿ƒåˆ é”™äº†ä½ å°±barbecueäº†~æˆ‘çš„å»ºè®®æ˜¯å…ˆå»ºä¸€ä¸ªæ–°çš„è¿œç¨‹åº“ï¼Œå…ˆæŠŠæœ¬åœ°.gitåº“æ‹·ä¸Šå»ï¼Œç¡®å®šæ²¡é—®é¢˜äº†å†åˆ è€çš„åº“

è¿™ä¸‹å†å›å»çœ‹Billing and plansï¼Œç»ˆäºé™å•¦ï¼å–œå¤§æ™®å¥”

## æœ€å

å…¶å®ä¸åªæ˜¯LFSé€‚ç”¨äºè¿™ä¸ªæ“ä½œï¼ŒåŒ…æ‹¬å¦‚æœä½ ä¸å°å¿ƒä¸Šä¼ äº†æ•æ„Ÿä¿¡æ¯ï¼ˆæ¯”å¦‚æ•°æ®åº“çš„ä¿¡æ¯ã€å¯†ç å•¥çš„ï¼‰ï¼Œæˆ‘ä¹‹å‰çš„åšæ³•ä¾ç„¶æ˜¯ç›´æ¥åˆ åº“ï¼Œä½†æ˜¯è¿™æ„å‘³ç€å‘Šåˆ«ä»¥å‰æ‰€æœ‰çš„commitè®°å½•ï¼Œå¿ƒé‡Œæœ‰äº›ä¸èˆã€‚ä½†ç”¨bfgç›´æ¥æï¼ŒæŠŠå†å²è®°å½•åˆ é™¤æ‰ï¼ˆä¸ç”¨æ‰§è¡Œæœ€åçš„â€œåˆ åº“è·‘è·¯â€æ“ä½œï¼Œâ€œåˆ åº“è·‘è·¯â€åªæ˜¯å¯¹äºLFSè€Œè¨€éœ€è¦ï¼‰ï¼Œå°±OKäº†ã€‚

æœ¬ç« æ¯•ã€‚